;   Here be dragons

AFFECT [[1224665461898798997]]
    TRAVERSE [[8397993708429497603]]
        LOCATE BEFORE ALL
        INSERT {
            property ~&197102514&~ ~&233745975898428&~: ~&6504117156&~
            property alias toolbarComponent: toolbarComponent
            property alias ~&7842069035455457876&~: ~&7842069035455457876&~
            property alias ~&7082729395218&~: ~&7082729395218&~
        }

        TRAVERSE [[6502786168]]#[[15549782143769420265]]
            TRAVERSE [[233704648923420]]
                REMOVE [[5972374]]
            END TRAVERSE
            REDEFINE [[233704648923420]]
                LOCATE BEFORE ALL INSERT STREAM ?
                    ~&254480451320573660&~ {
                        ~&5972374&~: toolbarComponent
                 ?
                LOCATE AFTER ALL INSERT STREAM ? } ?
            END REDEFINE
        END TRAVERSE
    END TRAVERSE
END AFFECT
AFFECT [[2328484894988065446]]
    IMPORT com.remarkable 1.0
    TRAVERSE [[8397788359424131273]]
        LOCATE BEFORE ALL INSERT {
            property bool mainDocumentSelected: ~&6504329801&~
            property bool toolbarShown: ~&6504329801&~
            property bool anyToolbarButtonVisible: (~&15793094956877902211&~.~&233748328658231&~ || rmhDocumentViewSplit.~&233748328658231&~) && !~&15793094956877902211&~.~&6503936152&~?.~&17074068313272002312&~ && !rmhDocumentViewSplit.~&6503936152&~?.~&17074068313272002312&~
            function setToolbarShown(~&180970&~) {
                toolbarShown = ~&180970&~;
                ~&15793094956877902211&~.~&6503936152&~.setToolbarVisibility(toolbarShown);
                rmhDocumentViewSplit.~&6503936152&~.setToolbarVisibility(toolbarShown);
            }
        }
    END TRAVERSE
    TRAVERSE [[8397788359424131273]] > [[8397993708429497603]]#[[7713531976371484]] > [[8397993708429497603]]#[[7713694313857736]]
        LOCATE BEFORE [[1125388591384953219]]

        INSERT {
            ~&254501108490678590&~ {
                ~&214646099849&~: ~&7082020628281&~.~&10749017317419834328&~
                ~&7082729686082&~: ~&7082020628281&~.~&10749017317419834328&~
                ~&214622605608&~: ~&7082020628281&~.~&8399340017260114793&~
                ~&233748328658231&~: toolbarShown && anyToolbarButtonVisible
                ~&180993&~: ~&7082020628281&~.~&800940498672108403&~ ? 0 : ~&7083038346995&~.~&214646099849&~ - ~&214646099849&~
            }
            /* Replacement for the toolbar show / hide button.*/
            ~&254501108490678590&~ {
                ~&180993&~: ~&7082020628281&~.~&800940498672108403&~ ? 0 : ~&7083038346995&~.~&214646099849&~ - ~&214646099849&~
                ~&214646099849&~: ~&7082020628281&~.~&10749017317419834328&~
                ~&7082729686082&~: ~&214646099849&~
                ~&7713532151049593&~: ~&7082020628281&~.~&800940498672108403&~ ? 0 : 90
                ~&233748328658231&~: anyToolbarButtonVisible
                ~&214622605608&~: ~&"503220030291830651&~

                ~&425121728314878811&~.~&6502767986&~ {
                    ~&233721384511543&~.~&7712879746914881&~: ~&7083038346995&~
                    ~&7083172477658&~: toolbarShown ? ~&"4663243347623906140&~ : ~&"4663243347624300739&~
                    ~&6504284228&~: ~&7082020628281&~.~&3842193742606557678&~
                    ~&15640708674084664669&~: ~&7082514258149&~.~&15640708674084664669&~
                }
                ~&254494525842443467&~ {
                    ~&233721384511543&~.~&6503816592&~: ~&7083038346995&~
                    ~&254542236275632405&~: {
                        setToolbarShown(!toolbarShown);
                    }
                }
            }
            ~&7081645463424&~ {
                ~&5972374&~: mainToolbar
                ~&16021043814775702381&~: ~&15793094956877902211&~.~&6503936152&~.toolbarComponent
                ~&233748328658231&~: ~&15793094956877902211&~.~&6503936152&~.~&233748328658231&~ && mainDocumentSelected
                ~&15648605738915750485&~: ~&214625660372&~

                ~&7082729686082&~: ~&6504254477&~.~&7082729686082&~ - ~&15793094956877902211&~.~&6503936152&~.~&7082729395218&~.~&7082729686082&~
                ~&180994&~: ~&15793094956877902211&~.~&6503936152&~.~&7082729395218&~.~&7082729686082&~
            }
            ~&7081645463424&~ {
                ~&5972374&~: altToolbar
                ~&16021043814775702381&~: rmhDocumentViewSplit.~&6503936152&~.toolbarComponent
                ~&233748328658231&~: rmhDocumentViewSplit.~&6503936152&~.~&233748328658231&~ && !mainDocumentSelected
                ~&15648605738915750485&~: ~&214625660372&~

                ~&7082729686082&~: ~&6504254477&~.~&7082729686082&~ - ~&15793094956877902211&~.~&6503936152&~.~&7082729395218&~.~&7082729686082&~
                ~&180994&~: ~&15793094956877902211&~.~&6503936152&~.~&7082729395218&~.~&7082729686082&~
            }
        }
    END TRAVERSE
END AFFECT

;   Remove the hide / show toolbar buttons from DHeader and DView
AFFECT [[5494459121428005411]]
    TRAVERSE [[6502786168]]
        TRAVERSE [[6502786168]] > [[8397817224039939104]]
            LOCATE BEFORE ALL
            INSERT { ~&233748328658231&~: ~&214625660372&~ }
        END TRAVERSE
        TRAVERSE [[254501108490678590]]
            LOCATE BEFORE ALL
            INSERT { ~&233748328658231&~: ~&214625660372&~ }
        END TRAVERSE
    END TRAVERSE
END AFFECT
AFFECT [[1224665461898798997]]
    TRAVERSE [[8397993708429497603]]
        TRAVERSE [[6502786168]]#[[15549782143769420265]] > [[12063136275370041354]]#[[4274231714942744504]]
            REPLACE [[233748328658231]] WITH { ~&233748328658231&~: ~&214625660372&~ }
        END TRAVERSE

        ;   Insert the replacement for enabling / disabling the toolbars.
        LOCATE BEFORE ALL
        INSERT {
            function setToolbarVisibility(vis) {
                ~&5972376&~(vis) {
                    ~&4274231714942744504&~.~&233723896107736&~(~&6504117156&~);
                } ~&6503784146&~ {
                    ~&7082729395218&~.~&5397586260524243623&~(~&214625660372&~);
                }
            }
        }
    END TRAVERSE
END AFFECT
